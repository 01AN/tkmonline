<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <title>Tkm Online</title>
    <link rel="stylesheet" href="./css/index.css">
</head>
<body>
    <div id="header">
        Tkm Online ( <a href="http://www57.atwiki.jp/tkmonline/" target="_blank">wiki</a> | <a href="http://jbbs.livedoor.jp/netgame/12693/" target="_blank">bbs</a> )
    </div>

    <img id ="chess" src="img/chess.png" alt="chess" />

    <div id="roomList">
        <table>
            <tr>
                <td>
                    <span class="category">野良卓</span>
                </td>
            </tr>
            <tr>
                <td>
                    <div id="room0" class="room">
                        <span class="count-empty">0</span><span class="title">カタソI</span>
                        <a href="cataso/I.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソIを開く" /></a>
                    </div>
                </td>
                <td>
                    <div id="room1" class="room">
                        <span class="count-empty">0</span><span class="title">カタソII</span>
                        <a href="cataso/II.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソIIを開く" /></a>
                    </div>
                </td>
                <td>
                    <div id="room2" class="room">
                        <span class="count-empty">0</span><span class="title">カタソIII</span>
                        <a href="cataso/III.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソIIIを開く" /></a>
                    </div>
                </td>
                <td>
                    <div id="room3" class="room">
                        <span class="count-empty">0</span><span class="title">カタソIV</span>
                        <a href="cataso/IV.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソIVを開く" /></a>
                    </div>
                </td>
                <td>
                    <div id="room4" class="room">
                        <span class="count-empty">0</span><span class="title">カタソV</span>
                        <a href="cataso/V.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソVを開く" /></a>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="category">身内卓</span>
                </td>
            </tr>
            <tr>
                <td>
                    <div id="room5" class="room">
                        <span class="count-empty">0</span><span class="title">カタソVI</span>
                        <a href="cataso/VI.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソVIを開く" /></a>
                    </div>
                </td>
                <td>
                    <div id="room6" class="room">
                        <span class="count-empty">0</span><span class="title">カタソVII</span>
                        <a href="cataso/VII.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソVIIを開く" /></a>
                    </div>
                </td>
                <td>
                    <div id="room7" class="room">
                        <span class="count-empty">0</span><span class="title">カタソVIII</span>
                        <a href="cataso/VIII.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソVIIIを開く" /></a>
                    </div>
                </td>
                <td>
                    <div id="room8" class="room">
                        <span class="count-empty">0</span><span class="title">カタソIX</span>
                        <a href="cataso/IX.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソIXを開く" /></a>
                    </div>
                </td>
                <td>
                    <div id="room9" class="room">
                        <span class="count-empty">0</span><span class="title">カタソX</span>
                        <a href="cataso/X.html" target="_blank"><img class="button" src="img/cataso-ready.png" alt="カタソXを開く" /></a>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <div id="footer">
        <p>対応ブラウザ : Chrome 16 以降, Firefox 11 以降, Safari 6 以降, IE 10 以降</p>
        <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://tkmax.github.io/tkmonline" data-text="TkmOnline" data-lang="ja">ツイート</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    </div>

    <script>
        var ws = new WebSocket('ws://localhost:7911');

        ws.onopen = function () {
            ws.send(String.fromCharCode(100));

            setInterval(
                function () {
                    ws.send(String.fromCharCode(100));
                }, 5000
            );
        }

        ws.onmessage = function (e) {
            var args, i, element;

            args = e.data.substring(1).split(' ');

            for (i = 0; i <= 9; i++) {
                element = document.getElementById('room' + i).getElementsByTagName('span')[0];
                element.textContent = args[i * 2];
                if (element.textContent === '0')
                    element.className = 'count-empty';
                else
                    element.className = 'count-orver';
                element = document.getElementById('room' + i).getElementsByTagName('img')[0];
                if (args[i * 2 + 1] === 'p')
                    element.src = './img/cataso-playing.png';
                else
                    element.src = './img/cataso-ready.png';
            }
        }
    </script>
</body>
</html>